# Prometheus Configuration for NFL SIM Monitoring

global:
  scrape_interval: 15s # Scrape targets every 15 seconds
  evaluation_interval: 15s # Evaluate rules every 15 seconds
  external_labels:
    monitor: "nfl-sim-monitor"
    environment: "production"

# Alertmanager configuration (optional)
alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - "alertmanager:9093"

# Load rules once and periodically evaluate them
rule_files:
  - "alert_rules.yml"

# Scrape configurations
scrape_configs:
  # NFL SIM Backend API
  - job_name: "nfl-sim-backend"
    metrics_path: "/metrics"
    static_configs:
      - targets: ["backend:8000"]
        labels:
          service: "backend-api"
          app: "nfl-sim"

    # Scrape more frequently for API metrics
    scrape_interval: 10s
    scrape_timeout: 5s

  # Prometheus itself
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]
        labels:
          service: "prometheus"

  # Node Exporter (system metrics)
  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]
        labels:
          service: "node-exporter"

    # Collect:
    # - CPU usage
    # - Memory usage
    # - Disk I/O
    # - Network stats

  # PostgreSQL Exporter (database metrics)
  - job_name: "postgres-exporter"
    static_configs:
      - targets: ["postgres-exporter:9187"]
        labels:
          service: "postgres"
          database: "nfl_sim"

    # Collect:
    # - Query performance
    # - Connection pool stats
    # - Table sizes
    # - Index usage

  # Docker container metrics (optional, if using cAdvisor)
  - job_name: "cadvisor"
    static_configs:
      - targets: ["cadvisor:8080"]
        labels:
          service: "cadvisor"

    # Collect:
    # - Container CPU
    # - Container memory
    # - Network usage per container
# Remote write configuration (for long-term storage, optional)
# remote_write:
#   - url: "https://your-remote-storage/api/v1/write"
#     basic_auth:
#       username: your_username
#       password: your_password
